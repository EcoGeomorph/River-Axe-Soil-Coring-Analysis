---
title: "An investigation of the long term ecological and soil carbon storage responses of the Upper Axe valley to landscape scale anthropogenic impacts"
author: "Julian Payne"
date: "2024"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

### MSc Land and Ecological Restoration - Research Project
# Validity of sample collection methodology
## For Shimadzu, data only available for weeks 1 and 3
## Wetlands split into BuriedWetlands (including RiverBed) located underneath grey clays
## and Wetlands for contemporary overlying wetland soils and associated grey clay

```{r}
knitr::opts_chunk$set(message=FALSE,warning=FALSE)
```

### Load packages
```{r}
library(tidyverse)
library(here)
library(ggfortify)
library(readxl)
library(cowplot)
library(vegan)
```

### Load the data for the project
```{r}
filepath<-here("data","Soil_Cores.xlsx")
Shimadzu<-read_excel(filepath,
                       sheet = "SoildataV3",
                       range = "A1:AE155")
```

### Set soil horizon layer order
```{r}
HorizonOrder<-c("Floodplain1", "Floodplain2", "Gley", "Wetland", "BuriedWetland")
PaleoHorizonOrder<-c("Floodplain1", "Gley", "Wetland", "BuriedWetland")
FldPlnHorizonOrder<-c("Floodplain1", "Floodplain2", "Gley", "BuriedWetland")
WetnessOrder<-c("Dry", "Damp", "Wet")
```

### Clean up the data

```{r}
Shimadzu_clean<-Shimadzu %>%
  filter(horizon_type == "Floodplain2" | horizon_type == "Floodplain1" | horizon_type == "Gley" | horizon_type == "Wetland" | horizon_type == "BuriedWetland") %>% 
  select(-fresh_weight) %>%
  drop_na()
```

## Summarise the data

```{r}
Shim_npoc_summary<-Shimadzu_clean %>%
  group_by(horizon_type) %>%
  summarise(mean.npoc = mean(npoc),
            se.npoc = sd(npoc/sqrt(n())))%>%
  arrange(HorizonOrder)
Shim_npoc_summary

Shim_tn_summary<-Shimadzu_clean %>%
  group_by(horizon_type) %>%
  summarise(mean.tn = mean(tn),
            se.tn = sd(tn/sqrt(n())))
Shim_tn_summary
```

# Analysis of Date influence

```{r}
DateNPOC_model<-lm(log(npoc)~date,data=Shimadzu_clean)
autoplot(DateNPOC_model)[1:2] + theme_cowplot()
anova(DateNPOC_model)

```

```{r}
Shimadzu_clean%>%
  ggplot(aes(y = npoc, x = date)) + 
  labs (y = "NPOC", x = "Date of collection", title = "NPOC variance with sample date") + # axis labels
  geom_point(size = 2,alpha=0.5) + 
  geom_smooth(method="lm",se=FALSE)+
  theme_cowplot()
```

# Analysis with respect to Week of sample collection

## Plot the NPOC data

```{r}
Shimadzu_clean%>%
  ggplot(aes(x=Week, y=npoc, ymin = 0)) +
  geom_boxplot()+
 geom_jitter(width=0.1, colour = "#f03b20",alpha=0.5) +
    labs(x = "Week of collection",
       y = "NPOC",
       title = "Variation of NPOC with sample collection week") +
  theme_cowplot() 
```

## Test if soil samples from different weeks are significantly different

```{r}
Week1npoc<-Shimadzu_clean %>%
  filter(Week=="Week1") %>% 
  select(npoc) %>%
  pull() 
Week3npoc<-Shimadzu_clean %>%
  filter(Week=="Week3") %>% 
  select(npoc) %>%
  pull() 
t.test(Week1npoc,Week3npoc)
```

## NPOC with soil horizon and week

```{r}
Shimadzu_clean%>%
  ggplot(aes(x=reorder(horizon_type,Horizon_order), y=npoc, ymin = 0, colour = Week)) +
  geom_boxplot()+
  geom_point(position = position_jitterdodge())+
    labs(x = "Soil Horizon",
       y = "NPOC",
       title = "Variation of NPOC with soil horizon and collection week") +
  theme_cowplot() +
  theme(legend.position = c(0.01,0.70), legend.title = element_text(size =12), legend.text = element_text(size=10))
```

## Test if soil samples from different weeks are significantly different

### Floodplain1
```{r}
Week1npoc<-Shimadzu_clean %>%
  filter(Week=="Week1") %>% 
  filter(horizon_type=="Floodplain1")%>%
  select(npoc) %>%
  pull() 
Week3npoc<-Shimadzu_clean %>%
  filter(Week=="Week3") %>% 
  filter(horizon_type=="Floodplain1")%>%
  select(npoc) %>%
  pull() 
t.test(Week1npoc,Week3npoc)
```

### Gley
```{r}
Week1npoc<-Shimadzu_clean %>%
  filter(Week=="Week1") %>% 
  filter(horizon_type=="Gley")%>%
  select(npoc) %>%
  pull() 
Week3npoc<-Shimadzu_clean %>%
  filter(Week=="Week3") %>% 
  filter(horizon_type=="Gley")%>%
  select(npoc) %>%
  pull() 
t.test(Week1npoc,Week3npoc)
```

### Buried Wetland
```{r}
Week1npoc<-Shimadzu_clean %>%
  filter(Week=="Week1") %>% 
  filter(horizon_type=="BuriedWetland")%>%
  select(npoc) %>%
  pull() 
Week3npoc<-Shimadzu_clean %>%
  filter(Week=="Week3") %>% 
  filter(horizon_type=="BuriedWetland")%>%
  select(npoc) %>%
  pull() 
t.test(Week1npoc,Week3npoc)
```

## NPOC with soil Wetness and week

```{r}
Shimadzu_clean%>%
  ggplot(aes(x=factor(wetdrydamp,WetnessOrder), y=npoc, ymin = 0, colour =Week)) +
  geom_boxplot()+
   geom_point(position = position_jitterdodge())+
   labs(x = "Soil wetness",
       y = "NPOC",
       title = "Variation of NPOC with soil wetness and collection week") +
  theme_cowplot()  +
  theme(legend.position = c(0.01,0.9), legend.title = element_text(size =12), legend.text = element_text(size=10))
```

## Test if soil samples from different weeks are significantly different

### Dry
```{r}
Week1npoc<-Shimadzu_clean %>%
  filter(Week=="Week1") %>% 
  filter(wetdrydamp=="Dry")%>%
  select(npoc) %>%
  pull() 
Week3npoc<-Shimadzu_clean %>%
  filter(Week=="Week3") %>% 
  filter(wetdrydamp=="Dry")%>%
  select(npoc) %>%
  pull() 
t.test(Week1npoc,Week3npoc)
```

### Damp
```{r}
Week1npoc<-Shimadzu_clean %>%
  filter(Week=="Week1") %>% 
  filter(wetdrydamp=="Damp")%>%
  select(npoc) %>%
  pull() 
Week3npoc<-Shimadzu_clean %>%
  filter(Week=="Week3") %>% 
  filter(wetdrydamp=="Damp")%>%
  select(npoc) %>%
  pull() 
t.test(Week1npoc,Week3npoc)
```

### Wet
```{r}
Week1npoc<-Shimadzu_clean %>%
  filter(Week=="Week1") %>% 
  filter(wetdrydamp=="Wet")%>%
  select(npoc) %>%
  pull() 
Week3npoc<-Shimadzu_clean %>%
  filter(Week=="Week3") %>% 
  filter(wetdrydamp=="Wet")%>%
  select(npoc) %>%
  pull() 
t.test(Week1npoc,Week3npoc)
```

# Analysis with resepct to time to freezing

## Analysis of Date influence

```{r}
DateNPOC_model<-lm(log(npoc)~TimeToFreeze,data=Shimadzu_clean)
autoplot(DateNPOC_model)[1:2] + theme_cowplot()
anova(DateNPOC_model)
```

```{r}
Shimadzu_clean%>%
  ggplot(aes(y = npoc, x = TimeToFreeze)) + 
  labs (y = "NPOC", x = "Number of days until samples were frozen", title = "NPOC variance with days till sample freezing") + 
  geom_point(size = 2,alpha=0.5) + 
  geom_smooth(method="lm",se=FALSE)+
  theme_cowplot()+
  scale_x_continuous(breaks=seq(0,3, by=1))+
  theme(plot.title = element_text(size=14,))
```

## Plot the NPOC data

```{r}
Shimadzu_clean%>%
  ggplot(aes(x=TimeToFreeze, y=npoc, ymin = 0, colour = factor(TimeToFreeze))) +
  geom_boxplot()+
 geom_jitter(width=0.1, colour = "#f03b20",alpha=0.5) +
    labs(x = "Number of days until samples were frozen",
       y = "NPOC",
       title = "NPOC variance with days till sample freezing",
       colour = "Days till frozen") +
  theme_cowplot()  +
  theme(legend.position = c(0.01,0.85), legend.title = element_text(size =12), legend.text = element_text(size=10))
```

## Test if soil samples with different times to freezing are significantly different

```{r}
Day1npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==1) %>% 
  select(npoc) %>%
  pull() 
Day2npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==2) %>% 
  select(npoc) %>%
  pull() 
Day3npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==3) %>% 
  select(npoc) %>%
  pull() 
t.test(Day1npoc,Day2npoc)
t.test(Day1npoc,Day3npoc)
t.test(Day2npoc,Day3npoc)
```

```{r}
Shimadzu_clean%>%
ggplot(aes(x=reorder(horizon_type,Horizon_order), y=npoc, ymin = 0, colour = factor(TimeToFreeze))) +
  geom_boxplot()+
  geom_point(position = position_jitterdodge())+
    labs(x = "Soil Horizon",
       y = "NPOC",
       title = "NPOC variance with days till sample freezing by soil horizon",
       colour = "Days till frozen") +
  theme_cowplot() +
  theme(title = element_text(size=11))+
  theme(legend.position = c(0.01,0.85), legend.title = element_text(size =12), legend.text = element_text(size=10))
```

## Test if soil samples from different days are significantly different

### Floodplain1
```{r}
day1npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==1) %>% 
  filter(horizon_type=="Floodplain1")%>%
  select(npoc) %>%
  pull() 
day2npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==2) %>% 
  filter(horizon_type=="Floodplain1")%>%
  select(npoc) %>%
  pull() 
day3npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==3) %>% 
  filter(horizon_type=="Floodplain1")%>%
  select(npoc) %>%
  pull() 
t.test(day1npoc,day2npoc)
t.test(day1npoc,day3npoc)
t.test(day2npoc,day3npoc)
```

### Gley
```{r}
day1npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==1) %>% 
  filter(horizon_type=="Gley")%>%
  select(npoc) %>%
  pull() 
day2npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==2) %>% 
  filter(horizon_type=="Gley")%>%
  select(npoc) %>%
  pull() 
day3npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==3) %>% 
  filter(horizon_type=="Gley")%>%
  select(npoc) %>%
  pull() 
t.test(day1npoc,day2npoc)
t.test(day1npoc,day3npoc)
t.test(day2npoc,day3npoc)
```

### Buried Wetland
```{r}
day1npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==1) %>% 
  filter(horizon_type=="BuriedWetland")%>%
  select(npoc) %>%
  pull() 
day2npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==2) %>% 
  filter(horizon_type=="BuriedWetland")%>%
  select(npoc) %>%
  pull() 
day3npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==3) %>% 
  filter(horizon_type=="BuriedWetland")%>%
  select(npoc) %>%
  pull() 
t.test(day1npoc,day2npoc)
t.test(day1npoc,day3npoc)
t.test(day2npoc,day3npoc)
```


```{r}
Shimadzu_clean%>%
  ggplot(aes(x=factor(wetdrydamp,WetnessOrder), y=npoc, ymin = 0, colour =factor(TimeToFreeze))) +
  geom_boxplot()+
   geom_point(position = position_jitterdodge())+
   labs(x = "Soil wetness",
       y = "NPOC",
       title = "NPOC variance with days till sample freezing by soil wetness",
       colour = "Days till frozen") +
  theme_cowplot() +
  theme(title = element_text(size=11))+
  theme(legend.position = c(0.01,0.85), legend.title = element_text(size =12), legend.text = element_text(size=10))
```

## Test if soil samples from different days are significantly different

### Dry
```{r}
day1npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==1) %>% 
  filter(wetdrydamp=="Dry")%>%
  select(npoc) %>%
  pull() 
day2npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==2) %>% 
  filter(wetdrydamp=="Dry")%>%
  select(npoc) %>%
  pull() 
day3npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==3) %>% 
  filter(wetdrydamp=="Dry")%>%
  select(npoc) %>%
  pull() 
t.test(day1npoc,day2npoc)
t.test(day1npoc,day3npoc)
t.test(day2npoc,day3npoc)
```

### Damp
```{r}
day1npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==1) %>% 
  filter(wetdrydamp=="Damp")%>%
  select(npoc) %>%
  pull() 
day2npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==2) %>% 
  filter(wetdrydamp=="Damp")%>%
  select(npoc) %>%
  pull() 
day3npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==3) %>% 
  filter(wetdrydamp=="Damp")%>%
  select(npoc) %>%
  pull() 
t.test(day1npoc,day2npoc)
t.test(day1npoc,day3npoc)
t.test(day2npoc,day3npoc)
```

### Wet
```{r}
day1npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==1) %>% 
  filter(wetdrydamp=="Wet")%>%
  select(npoc) %>%
  pull() 
day2npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==2) %>% 
  filter(wetdrydamp=="Wet")%>%
  select(npoc) %>%
  pull() 
day3npoc<-Shimadzu_clean %>%
  filter(TimeToFreeze==3) %>% 
  filter(wetdrydamp=="Wet")%>%
  select(npoc) %>%
  pull() 
t.test(day1npoc,day2npoc)
t.test(day1npoc,day3npoc)
t.test(day2npoc,day3npoc)
```

# Analysis of Date influence for TN

```{r}
Datetn_model<-lm(log(tn)~date,data=Shimadzu_clean)
autoplot(Datetn_model)[1:2] + theme_cowplot()
anova(Datetn_model)

```

```{r}
Shimadzu_clean%>%
  ggplot(aes(y = tn, x = date)) + 
  labs (y = "TN", x = "Date of collection", title = "TN variance with sample date") + # axis labels
  geom_point(size = 2,alpha=0.5) + 
  geom_smooth(method="lm",se=FALSE)+
  theme_cowplot()
```

## Analysis with respect to Week of sample collection

## Plot the TN data

```{r}
Shimadzu_clean%>%
  ggplot(aes(x=Week, y=tn, ymin = 0)) +
  geom_boxplot()+
 geom_jitter(width=0.1, colour = "#f03b20",alpha=0.5) +
    labs(x = "Week of collection",
       y = "TN",
       title = "Variation of Tn with sample collection week") +
  theme_cowplot() 
```

## Test if soil samples from different weeks are significantly different

```{r}
Week1tn<-Shimadzu_clean %>%
  filter(Week=="Week1") %>% 
  select(tn) %>%
  pull() 
Week3tn<-Shimadzu_clean %>%
  filter(Week=="Week3") %>% 
  select(tn) %>%
  pull() 
t.test(Week1tn,Week3tn)
```

## TN with soil horizon and week

```{r}
Shimadzu_clean%>%
  ggplot(aes(x=reorder(horizon_type,Horizon_order), y=tn, ymin = 0, colour = Week)) +
  geom_boxplot()+
  geom_point(position = position_jitterdodge())+
    labs(x = "Soil Horizon",
       y = "TN",
       title = "Variation of TN with soil horizon and collection week") +
  theme_cowplot() +
  theme(legend.position = c(0.01,0.85), legend.title = element_text(size =12), legend.text = element_text(size=10))
```

## Test if soil samples from different weeks are significantly different

### Floodplain1
```{r}
Week1tn<-Shimadzu_clean %>%
  filter(Week=="Week1") %>% 
  filter(horizon_type=="Floodplain1")%>%
  select(tn) %>%
  pull() 
Week3tn<-Shimadzu_clean %>%
  filter(Week=="Week3") %>% 
  filter(horizon_type=="Floodplain1")%>%
  select(tn) %>%
  pull() 
t.test(Week1tn,Week3tn)
```

### Gley
```{r}
Week1tn<-Shimadzu_clean %>%
  filter(Week=="Week1") %>% 
  filter(horizon_type=="Gley")%>%
  select(tn) %>%
  pull() 
Week3tn<-Shimadzu_clean %>%
  filter(Week=="Week3") %>% 
  filter(horizon_type=="Gley")%>%
  select(tn) %>%
  pull() 
t.test(Week1tn,Week3tn)
```

### Buried Wetland
```{r}
Week1tn<-Shimadzu_clean %>%
  filter(Week=="Week1") %>% 
  filter(horizon_type=="BuriedWetland")%>%
  select(tn) %>%
  pull() 
Week3tn<-Shimadzu_clean %>%
  filter(Week=="Week3") %>% 
  filter(horizon_type=="BuriedWetland")%>%
  select(tn) %>%
  pull() 
t.test(Week1tn,Week3tn)
```


## tn with soil Wetness and week

```{r}
Shimadzu_clean%>%
  ggplot(aes(x=factor(wetdrydamp,WetnessOrder), y=tn, ymin = 0, colour =Week)) +
  geom_boxplot()+
   geom_point(position = position_jitterdodge())+
   labs(x = "Soil wetness",
       y = "TN",
       title = "Variation of TN with soil wetness and collection week") +
  theme_cowplot() +
  theme(legend.position = c(0.01,0.85), legend.title = element_text(size =12), legend.text = element_text(size=10))
```

## Test if soil samples from different weeks are significantly different

### Dry
```{r}
Week1tn<-Shimadzu_clean %>%
  filter(Week=="Week1") %>% 
  filter(wetdrydamp=="Dry")%>%
  select(tn) %>%
  pull() 
Week3tn<-Shimadzu_clean %>%
  filter(Week=="Week3") %>% 
  filter(wetdrydamp=="Dry")%>%
  select(tn) %>%
  pull() 
t.test(Week1tn,Week3tn)
```

### Damp
```{r}
Week1tn<-Shimadzu_clean %>%
  filter(Week=="Week1") %>% 
  filter(wetdrydamp=="Damp")%>%
  select(tn) %>%
  pull() 
Week3tn<-Shimadzu_clean %>%
  filter(Week=="Week3") %>% 
  filter(wetdrydamp=="Damp")%>%
  select(tn) %>%
  pull() 
t.test(Week1tn,Week3tn)
```

### Wet
```{r}
Week1tn<-Shimadzu_clean %>%
  filter(Week=="Week1") %>% 
  filter(wetdrydamp=="Wet")%>%
  select(tn) %>%
  pull() 
Week3npoc<-Shimadzu_clean %>%
  filter(Week=="Week3") %>% 
  filter(wetdrydamp=="Wet")%>%
  select(tn) %>%
  pull() 
t.test(Week1tn,Week3tn)
```

# anlaysis with respect to time to freezing

## Analysis of Date influence

```{r}
Datetn_model<-lm(log(tn)~TimeToFreeze,data=Shimadzu_clean)
autoplot(Datetn_model)[1:2] + theme_cowplot()
anova(Datetn_model)
```

```{r}
Shimadzu_clean%>%
  ggplot(aes(y = tn, x = TimeToFreeze)) + 
  labs (y = "TN", x = "Number of days till samples were frozen", title = "TN variance with days till sample freezing") + 
  geom_point(size = 2,alpha=0.5) + 
  geom_smooth(method="lm",se=FALSE)+
  theme_cowplot()+
  scale_x_continuous(breaks=seq(0,3, by=1))
```

## Plot the tn data

```{r}
Shimadzu_clean%>%
  ggplot(aes(x=TimeToFreeze, y=tn, ymin = 0, colour = factor(TimeToFreeze))) +
  geom_boxplot()+
 geom_jitter(width=0.1, colour = "#f03b20",alpha=0.5) +
    labs(x = "Number of days until samples were frozen",
       y = "TN",
       title = "TN variance with days till sample freezing by soil horizon",
       colour = "Days till frozen") +
  theme_cowplot() +
  theme(legend.position = c(0.01,0.85), legend.title = element_text(size =12), legend.text = element_text(size=10))
```

## Test if soil samples from different weeks are significantly different

```{r}
Day1tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==1) %>% 
  select(tn) %>%
  pull() 
Day2tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==2) %>% 
  select(tn) %>%
  pull() 
Day3tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==3) %>% 
  select(tn) %>%
  pull() 
t.test(Day1tn,Day2tn)
t.test(Day1tn,Day3tn)
t.test(Day2tn,Day3tn)
```

## Plot Tn data

```{r}
Shimadzu_clean%>%
  ggplot(aes(x=reorder(horizon_type,Horizon_order), y=tn, ymin = 0, colour = factor(TimeToFreeze))) +
  geom_boxplot()+
  geom_point(position = position_jitterdodge())+
    labs(x = "Soil Horizon",
       y = "TN",
       title = "TN variance with days till sample freezing by soil horizon",
       colour = "Days till frozen") +
  theme_cowplot() +
  theme(legend.position = c(0.01,0.70), legend.title = element_text(size =12), legend.text = element_text(size=10))
```

## Test if soil samples from different days are significantly different

### Floodplain1
```{r}
day1tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==1) %>% 
  filter(horizon_type=="Floodplain1")%>%
  select(tn) %>%
  pull() 
day2tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==2) %>% 
  filter(horizon_type=="Floodplain1")%>%
  select(tn) %>%
  pull() 
day3tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==3) %>% 
  filter(horizon_type=="Floodplain1")%>%
  select(tn) %>%
  pull() 
t.test(day1tn,day2tn)
t.test(day1tn,day3tn)
t.test(day2tn,day3tn)
```

### Gley
```{r}
day1tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==1) %>% 
  filter(horizon_type=="Gley")%>%
  select(tn) %>%
  pull() 
day2tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==2) %>% 
  filter(horizon_type=="Gley")%>%
  select(tn) %>%
  pull() 
day3tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==3) %>% 
  filter(horizon_type=="Gley")%>%
  select(tn) %>%
  pull() 
t.test(day1tn,day2tn)
t.test(day1tn,day3tn)
t.test(day2tn,day3tn)
```

### Buried Wetland
```{r}
day1tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==1) %>% 
  filter(horizon_type=="BuriedWetland")%>%
  select(tn) %>%
  pull() 
day2tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==2) %>% 
  filter(horizon_type=="BuriedWetland")%>%
  select(tn) %>%
  pull() 
day3tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==3) %>% 
  filter(horizon_type=="BuriedWetland")%>%
  select(tn) %>%
  pull() 
t.test(day1tn,day2tn)
t.test(day1tn,day3tn)
t.test(day2tn,day3tn)
```


```{r}
Shimadzu_clean%>%
  ggplot(aes(x=factor(wetdrydamp,WetnessOrder), y=tn, ymin = 0, colour = factor(TimeToFreeze))) +
  geom_boxplot()+
  geom_point(position = position_jitterdodge())+
    labs(x = "Days till samples were frozen",
       y = "Tn",
       title = "TN variance with days till sample freezing by soil wetness",
       colour = "Days till frozen") +
  theme_cowplot() +
  theme(legend.position = c(0.01,0.85), legend.title = element_text(size =12), legend.text = element_text(size=10))
```


## Test if soil samples from different days are significantly different

### Dry
```{r}
day1tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==1) %>% 
  filter(wetdrydamp=="Dry")%>%
  select(tn) %>%
  pull() 
day2tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==2) %>% 
  filter(wetdrydamp=="Dry")%>%
  select(tn) %>%
  pull() 
day3tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==3) %>% 
  filter(wetdrydamp=="Dry")%>%
  select(tn) %>%
  pull() 
t.test(day1tn,day2tn)
t.test(day1tn,day3tn)
t.test(day2tn,day3tn)
```

### Damp
```{r}
day1tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==1) %>% 
  filter(wetdrydamp=="Damp")%>%
  select(tn) %>%
  pull() 
day2tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==2) %>% 
  filter(wetdrydamp=="Damp")%>%
  select(tn) %>%
  pull() 
day3tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==3) %>% 
  filter(wetdrydamp=="Damp")%>%
  select(tn) %>%
  pull() 
t.test(day1tn,day2tn)
t.test(day1tn,day3tn)
t.test(day2tn,day3tn)
```

### Wet
```{r}
day1tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==1) %>% 
  filter(wetdrydamp=="Wet")%>%
  select(tn) %>%
  pull() 
day2tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==2) %>% 
  filter(wetdrydamp=="Wet")%>%
  select(tn) %>%
  pull() 
day3tn<-Shimadzu_clean %>%
  filter(TimeToFreeze==3) %>% 
  filter(wetdrydamp=="Wet")%>%
  select(tn) %>%
  pull() 
t.test(day1tn,day2tn)
t.test(day1tn,day3tn)
t.test(day2tn,day3tn)
```
